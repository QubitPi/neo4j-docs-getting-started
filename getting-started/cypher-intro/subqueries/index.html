<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, minimum-scale=1">
    <meta name="msvalidate.01" content="B5163518CBE4A854B63801277FE5E35C" />
    <meta name="google-site-verification" content="ucqagxjVuq0lJZeLKs0F5AppzK111lNt3IoxU6mzlJE" />
    <meta name="robots" content="index, follow" />
    <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
    <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />

    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-WK23PSS');</script>
<!-- Hotjar Tracking Code for staging -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:3587741,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
<!-- End Hotjar Tracking code -->
    <title>Subqueries in Cypher - Getting Started</title>
    <link rel="prev" href="../large-statements/">
    <link rel="next" href="../schema/">
      <meta name="description" content="Building on the previous Cypher guides, this guide shows how to write subqueries.">
<link rel="stylesheet" href="https://neo4j.com/wp-content/themes/neo4jweb/assets/neo4j-react-modules-assets/search-preact/chunkless/bundle.css" />
<link rel="stylesheet" href="https://neo4j.com/wp-content/themes/neo4jweb/assets/neo4j-react-modules-assets/search-preact/chunkless/utilities.min.css" />

    <link rel="preload" href="../../../assets/fonts/fontawesome-webfont.woff2?v=4.7.0" as="font">
    <link rel="stylesheet" href="../../../assets/css/site.css">
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">

    <link rel="shortcut icon" href="https://neo4j.com/wp-content/themes/neo4jweb/favicon.ico" />



    <meta property="neo:type" content="Docs">
    <meta property="neo:site" content="Reference Docs">


    <meta property="og:site_name" content="Neo4j Graph Data Platform" />
    <meta property="article:publisher" content="https://www.facebook.com/neo4j.graph.database" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:creator" content="@neo4j" />
    <meta name="twitter:site" content="@neo4j" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Subqueries in Cypher - Getting Started" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:image" content="https://dist.neo4j.com/wp-content/uploads/20210423062553/neo4j-social-share-21.png" />
    <meta property="og:description" content="Building on the previous Cypher guides, this guide shows how to write subqueries." />
    <meta property="og:url" content="https://neo4j.com/docs/getting-started/cypher-intro/subqueries/" />
    <link rel="shortcut icon" href="https://neo4j.com/wp-content/themes/neo4jweb/favicon.ico" />
  </head>
  <body class="article docs">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WK23PSS"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<script>(function(f,b){if(!b.__SV){var e,g,i,h;window.mixpanel=b;b._i=[];b.init=function(e,f,c){function g(a,d){var b=d.split(".");2==b.length&&(a=a[b[0]],d=b[1]);a[d]=function(){a.push([d].concat(Array.prototype.slice.call(arguments,0)))}}var a=b;"undefined"!==typeof c?a=b[c]=[]:c="mixpanel";a.people=a.people||[];a.toString=function(a){var d="mixpanel";"mixpanel"!==c&&(d+="."+c);a||(d+=" (stub)");return d};a.people.toString=function(){return a.toString(1)+".people (stub)"};i="disable time_event track track_pageview track_links track_forms track_with_groups add_group set_group remove_group register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking start_batch_senders people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user people.remove".split(" ");
for(h=0;h<i.length;h++)g(a,i[h]);var j="set set_once union unset remove delete".split(" ");a.get_group=function(){function b(c){d[c]=function(){call2_args=arguments;call2=[c].concat(Array.prototype.slice.call(call2_args,0));a.push([e,call2])}}for(var d={},e=["get_group"].concat(Array.prototype.slice.call(arguments,0)),c=0;c<j.length;c++)b(j[c]);return d};b._i.push([e,f,c])};b.__SV=1.2;e=f.createElement("script");e.type="text/javascript";e.async=!0;e.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?
MIXPANEL_CUSTOM_LIB_URL:"file:"===f.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";g=f.getElementsByTagName("script")[0];g.parentNode.insertBefore(e,g)}})(document,window.mixpanel||[]);
mixpanel.init("4bfb2414ab973c741b6f067bf06d5575", {batch_requests: true})
mixpanel.track("Page View", {
    pathname: window.location.origin + window.location.pathname,
    search: window.location.search,
    hash: window.location.hash,
    referrer: document.referrer,
})
</script>
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">

      <img class="navbar-logo" src="https://dist.neo4j.com/wp-content/uploads/20210422142941/neo4j-logo-2020.svg" alt="Neo4j Docs" />
      <a href="/docs/" class="navbar-item no-left-padding" aria-label="Docs">
        Docs
      </a>

      </div>

      <button class="navbar-search search-button" data-target="topbar-nav" id="search_open_mobile" aria-label="Open Search">
        <svg width="23px" height="23px" viewBox="0 0 23 23" version="1.1" class="fill-current float-right" id="searchx" role="button" title="Search Website">
          <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round"
            stroke-linejoin="round">
            <g transform="translate(-2.000000, -2.000000)" stroke="#a0aec0" stroke-width="1.5">
              <circle
                transform="translate(11.389364, 11.388564) rotate(-23.025000) translate(-11.389364, -11.388564) "
                cx="11.3893642" cy="11.3885639" r="8.056"></circle>
              <path d="M17.0853333,17.0844444 L23.3333333,23.3333333" ></path>
            </g>
          </g>
        </svg>
      </button>
      <button class="navbar-burger" data-target="topbar-nav" aria-label="Mobile Navigation Button">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
            <div class="navbar-end">


        <div class="navbar-item has-dropdown is-hoverable docs">
          <a class="navbar-link" href="/docs/">Docs</a>
          <div class="navbar-dropdown">
            <div class="navbar-item project">
              <span class="project-name">Neo4j DBMS</span>
              <ul class="project-links">
                <li><a href="/docs/getting-started/current/" class="project-link">Getting Started</a></li>
                <li><a href="/docs/operations-manual/current/" class="project-link">Operations</a></li>
                <li><a href="/docs/migration-guide/current/" class="project-link">Migration and Upgrade</a></li>
                <li><a href="/docs/status-codes/current/" class="project-link">Status Codes</a></li>
                <li><a href="/docs/java-reference/current/" class="project-link">Java Reference</a></li>
                <li><a href="/docs/kerberos-add-on/current/" class="project-link">Kerberos Add-on</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <a class="project-name" href="/docs/aura/">Neo4j Aura</a>
              <ul class="project-links">
                <li><a class="project-link" href="/docs/aura">Neo4j Aura</a></li>
                <li><a class="project-link" href="/docs/aura/auradb/">Neo4j AuraDB</a></li>
                <li><a class="project-link" href="/docs/aura/aurads/">Neo4j AuraDS</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <span class="project-name">Neo4j Tools</span>
              <ul class="project-links">
                <li><a href="/docs/bloom-user-guide/current/" class="project-link">Neo4j Bloom</a></li>
                <li><a href="/docs/browser-manual/current/" class="project-link">Neo4j Browser</a></li>
                <li><a href="/docs/data-importer/current/" class="project-link">Neo4j Data Importer</a></li>
                <li><a href="/docs/desktop-manual/current/" class="project-link">Neo4j Desktop</a></li>
                <li><a href="/docs/ops-manager/current/" class="project-link">Neo4j Ops Manager</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <span class="project-name">Neo4j Graph Data Science</span>
              <ul class="project-links">
                <li><a href="/docs/graph-data-science/current/" class="project-link">Neo4j Graph Data Science Library</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <span class="project-name">Cypher Query Language</span>
              <ul class="project-links">
                <li><a href="/docs/cypher-manual/current/" class="project-link">Cypher</a></li>
                <li><a href="/docs/cypher-cheat-sheet/current/" class="project-link">Cypher Cheat Sheet</a></li>
                <li><a href="/docs/apoc/current/" class="project-link">APOC Library</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <span class="project-name" href="/docs/drivers-apis">Create applications</span>
              <ul class="project-links">
                <li><a href="/docs/python-manual/current/" class="project-link">Python Driver</a></li>
                <li><a href="/docs/go-manual/current/" class="project-link">Go Driver</a></li>
                <li><a href="/docs/java-manual/current/" class="project-link">Java Driver</a></li>
                <li><a href="/docs/javascript-manual/current/" class="project-link">JavaScript Driver</a></li>
                <li><a href="/docs/dotnet-manual/current/" class="project-link">.Net Driver</a></li>
                <li><a href="/docs/graphql-manual/current/" class="project-link">Neo4j GraphQL Library</a></li>
                <li><a href="/docs/http-api/current/" class="project-link">HTTP API</a></li>
                <li><a href="/docs/ogm-manual/current/" class="project-link">OGM Library</a></li>
                <li><a href="https://docs.spring.io/spring-data/neo4j/docs/current/reference/html/#reference" class="project-link">Spring Data Neo4j</a></li>
                <li><a href="/docs/spark/" class="project-link">Neo4j Connector for Apache Spark</a></li>
                <li><a href="/docs/kafka/" class="project-link">Neo4j Connector for Apache Kafka</a></li>
              </ul>
            </div>

          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable labs">
          <a class="navbar-link" href="/labs/">Labs</a>
          <div class="navbar-dropdown">
            <div class="navbar-item project">
              <a class="project-name" href="/labs/arrows/">arrows.app</a>
              <ul class="project-links">
                <li><a href="/labs/arrows/" class="project-link">Details</a></li>
                <li><a href="https://arrows.app" class="project-link">arrows.app</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/apoc/">APOC Extended</a>

              <ul class="project-links">
                <li><a href="/labs/apoc/5/" class="project-link">Documentation</a></li>
                <li><a href="/developer/neo4j-apoc/" class="project-link">Developer Guide</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/halin/">Halin</a>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/etl-tool/">ETL Tool</a>
              <ul class="project-links">
                <li><a href="/labs/etl-tool/" class="project-link">Details</a></li>
                <li><a href="/labs/etl-tool/1.5.0/" class="project-link">Documentation</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/neo4j-migrations/">Neo4j Migrations</a>
              <ul class="project-links">
                <li><a href="/labs/neo4j-migrations/" class="project-link">Details</a></li>
                <li><a href="/labs/neo4j-migrations/2.0/" class="project-link">Documentation</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/liquibase/">Neo4j Plugin For Liquibase</a>
              <ul class="project-links">
                <li><a href="/labs/liquibase/" class="project-link">Details</a></li>
                <li><a href="https://github.com/liquibase/liquibase-neo4j" class="project-link">Documentation</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/neosemantics/">Neosemantics</a>
              <ul class="project-links">
                <li><a href="/labs/neosemantics/tutorial/" class="project-link">Getting Started</a></li>
                <li><a href="/labs/neosemantics/4.0/" class="project-link">Documentation</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/neo4j-helm/">Neo4j Helm</a>
              <ul class="project-links">
                <li><a href="/labs/neo4j-helm/" class="project-link">Details</a></li>
                <li><a href="/labs/neo4j-helm/1.0.0/" class="project-link">Documentation</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/neodash/">NeoDash</a>
              <ul class="project-links">
                <li><a href="/labs/neodash/" class="project-link">Details</a></li>
                <li><a href="/labs/neodash/2.1/" class="project-link">Documentation</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/neomodel/">neomodel</a>
              <ul class="project-links">
                <li><a href="/labs/neomodel/" class="project-link">Details</a></li>
                <li><a href="https://neomodel.readthedocs.io/en/latest/" target="_blank" class="project-link">Documentation</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable developer">
          <a class="navbar-link" href="/developer/resources/">Get Help</a>
          <div class="navbar-dropdown">
            <div class="navbar-item project">
              <a class="project-name" href="https://graphacademy.neo4j.com/?ref=docs" target="_blank">GraphAcademy</a>
              <ul class="project-links">
                <li><a class="project-link" href="https://graphacademy.neo4j.com/?ref=docs">Free, Self Paced Training</a></li>
                <li><a class="project-link" href="https://graphacademy.neo4j.com/certification/?ref=docs" target="_blank">Certification</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <a class="project-name" href="https://dev.neo4j.com/forum" target="_blank">Community Forum</a>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="https://dev.neo4j.com/chat" target="_blank">Discord Chat</a>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/developer/kb" target="_blank">Knowledge Base</a>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="https://medium.com/neo4j" target="_blank">Neo4j Developer Blog</a>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="https://www.youtube.com/neo4j" target="_blank">Neo4j Videos</a>
            </div>
          </div>
        </div>
        <div class="navbar-item is-hoverable getting-started-cta">
          <a class="navbar-link primary" href="https://neo4j.com/cloud/platform/aura-graph-database/?ref=docs-nav-get-started">Get Started Free</a>
        </div>
        <div class="navbar-item">
          <a class="navbar-link search-button" href="#search" id="search_open"><svg width="23px" height="23px" viewBox="0 0 23 23"
              version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
              class="fill-current float-right" id="search" role="button" title="Search Website">
              <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round"
                stroke-linejoin="round">
                <g transform="translate(-2.000000, -2.000000)" stroke="#a0aec0" stroke-width="1.5">
                  <circle
                    transform="translate(11.389364, 11.388564) rotate(-23.025000) translate(-11.389364, -11.388564) "
                    cx="11.3893642" cy="11.3885639" r="8.056"></circle>
                  <path d="M17.0853333,17.0844444 L23.3333333,23.3333333" ></path>
                </g>
              </g>
            </svg><span class="navbar-mobile">Search</span></a>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="getting-started" data-version="">
  <aside class="nav">
    <div class="panels">
      <div class="selectors">
        
      </div>
      <div class="nav-panel-menu is-active" data-panel="menu">
    <nav class="nav-menu">
    <ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../">Welcome to Neo4j</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../get-started-with-neo4j/">Get started with Neo4j</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../get-started-with-neo4j/graph-database/">What is a graph database?</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../data-modeling/">Model your data for Neo4j</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-modeling/guide-data-modeling/">Graph modeling guidelines</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-modeling/modeling-designs/">Modeling designs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-modeling/relational-to-graph-modeling/">Modeling: relational to graph</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-modeling/modeling-tips/">Graph modeling tips</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-modeling/graph-model-refactoring/">Graph model refactoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-modeling/data-modeling-tools/">Data modeling tools</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../data-import/">Import your data into Neo4j</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-import/csv-import/">Importing CSV data into Neo4j</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-import/json-rest-api-import/">Importing JSON data from a REST API into Neo4j</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-import/relational-to-graph-import/">Import: RDBMS to graph</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../">Query a Neo4j database</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cypher-sql/">Comparing Cypher with SQL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../patterns/">Patterns</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../patterns-in-practice/">Patterns in practice</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../results/">Getting the correct results</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../updating/">Updating the data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../large-statements/">Composing large statements</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="./">Subqueries in Cypher</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../schema/">Defining a schema</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../dates-datetimes-durations/">Dates, datetimes, and durations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../procedures-functions/">How to extend Cypher</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../load-csv/">Tutorial: Import data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../resources/">Cypher resources</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../languages-guides/">Connect to Neo4j</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link nav-item-toggle" href="../../languages-guides/java/java-intro/">Using Neo4j from Java</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../languages-guides/java/spring-data-neo4j/">Spring Data Neo4j</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../languages-guides/java/quarkus/">Quarkus</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../languages-guides/java/java-frameworks/">Helidon, Micronaut</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../languages-guides/java/neo4j-ogm/">Neo4j - OGM Object Graph Mapper</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../languages-guides/java/java-procedures/">Procedures and Functions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../languages-guides/neo4j-dotnet/">Using Neo4j from .NET</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../languages-guides/neo4j-javascript/">Neo4j from JavaScript</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../languages-guides/neo4j-python/">Using Neo4j from Python</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../languages-guides/neo4j-go/">Using Neo4j from Go</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../languages-guides/integration-tools/integration/">Neo4j Connectors</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../languages-guides/community-drivers/">Community-contributed libraries</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../gds/">Data science with Neo4j</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../graph-visualization/graph-visualization/">Visualize your data in Neo4j</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../graph-visualization/graph-visualization-tools/">Graph visualization tools</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../appendix/">Appendix</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link nav-item-toggle" href="../../appendix/graphdb-concepts/">Graph database concepts</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../appendix/graphdb-concepts/graphdb-vs-rdbms/">Transition from relational to graph database</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../appendix/graphdb-concepts/graphdb-vs-nosql/">Transition from NoSQL to graph database</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../appendix/example-data/">Example datasets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../appendix/getting-started-resources/">Getting started resources</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link nav-item-toggle" href="../../appendix/tutorials/tutorials-overview/">Tutorials</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../appendix/tutorials/guide-cypher-basics/">Tutorial: Getting Started with Cypher</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../appendix/tutorials/guide-build-a-recommendation-engine/">Tutorial: Build a Cypher Recommendation Engine</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../appendix/tutorials/guide-import-relational-and-etl/">Tutorial: Import data from a relational database into Neo4j</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../appendix/tutorials/guide-import-desktop-csv/">How-To: Import CSV data with Neo4j Desktop</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
  <div class="toolbar-wrapper">
    <button class="nav-toggle" aria-label="Toggle Table of Contents"></button>
    <a href="../../" class="home-link" aria-label="Go to home page"></a>
    <nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../">Getting Started</a></li>
    <li><a href="../">
        Query a Neo4j database
    </a></li>
    <li><a href="./">
        Subqueries in Cypher
    </a></li>
  </ul>
</nav>
        <div class="edit-this-page"><a href="https://github.com/neo4j/docs-getting-started/tree/master/modules/ROOT/pages/cypher-intro/subqueries.adoc">Edit this Page</a></div>
    </div>
</div>

  <div class="content">
<article class="doc">
<div class="sect-header">
<h1 class="page">Subqueries in Cypher</h1>
</div>





<div class="sect1">
<h2 id="recap"><a class="anchor" href="#recap"></a>Recap our example graph</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All of our code examples will continue with one of the graph examples we have been using before, but include some more data for the queries on this page.
Below is an image of the new graph, a network of people, the companies they work for, and the technologies they like.</p>
</div>
<div class="paragraph">
<p>We have added one more <code>Person</code> node (blue) who <code>WORKS_FOR</code> a <code>Company</code> node (red) and <code>LIKES</code> a <code>Technology</code> (green) node: <strong>Ryan</strong> works for <em>Company Z</em> and likes <strong>Python</strong>.
You can find this data on the right hand side of the graph.</p>
</div>
<div class="paragraph">
<p>To recap, each person could also have multiple <code>IS_FRIENDS_WITH</code> relationships to other people.</p>
</div>
<div class="imageblock popup-link">
<div class="content">
<img src="../../_images/people-technologies-graph-arr1.svg" alt="people technologies graph arr1">
</div>
<div class="title">Figure 1. Network of people, the companies they work for, and the technologies they like</div>
</div>
<div class="paragraph">
<p>You can create this dataset using the following Cypher<sup>&reg;</sup> query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE (diana:Person {name: "Diana"})-[:LIKES]-&gt;(query:Technology {type: "Query Languages"})
CREATE (melissa:Person {name: "Melissa", twitter: "@melissa"})-[:LIKES]-&gt;(query)
CREATE (dan:Person {name: "Dan", twitter: "@dan", yearsExperience: 6})-[:LIKES]-&gt;(etl:Technology {type: "Data ETL"})&lt;-[:LIKES]-(melissa)
CREATE (xyz:Company {name: "XYZ"})&lt;-[:WORKS_FOR]-(sally:Person {name: "Sally", yearsExperience: 4})-[:LIKES]-&gt;(integrations:Technology {type: "Integrations"})&lt;-[:LIKES]-(dan)
CREATE (sally)&lt;-[:IS_FRIENDS_WITH]-(john:Person {name: "John", yearsExperience: 5, birthdate: "1985-04-04"})-[:LIKES]-&gt;(java:Technology {type: "Java"})
CREATE (john)&lt;-[:IS_FRIENDS_WITH]-(jennifer:Person {name: "Jennifer", twitter: "@jennifer", yearsExperience: 5, birthdate: "1988-01-01"})-[:LIKES]-&gt;(java)
CREATE (john)-[:WORKS_FOR]-&gt;(xyz)
CREATE (sally)&lt;-[:IS_FRIENDS_WITH]-(jennifer)-[:IS_FRIENDS_WITH]-&gt;(melissa)
CREATE (joe:Person {name: "Joe", birthdate: "1988-08-08"})-[:LIKES]-&gt;(query)
CREATE (mark:Person {name: "Mark", twitter: "@mark"})
CREATE (ann:Person {name: "Ann"})
CREATE (x:Company {name: "Company X"})&lt;-[:WORKS_FOR]-(diana)&lt;-[:IS_FRIENDS_WITH]-(joe)-[:IS_FRIENDS_WITH]-&gt;(mark)-[:LIKES]-&gt;(graphs:Technology {type: "Graphs"})&lt;-[:LIKES]-(jennifer)-[:WORKS_FOR]-&gt;(:Company {name: "Neo4j"})
CREATE (ann)&lt;-[:IS_FRIENDS_WITH]-(jennifer)-[:IS_FRIENDS_WITH]-&gt;(mark)
CREATE (john)-[:LIKES]-&gt;(:Technology {type: "Application Development"})&lt;-[:LIKES]-(ann)-[:IS_FRIENDS_WITH]-&gt;(dan)-[:WORKS_FOR]-&gt;(abc:Company {name: "ABC"})
CREATE (ann)-[:WORKS_FOR]-&gt;(abc)
CREATE (a:Company {name: "Company A"})&lt;-[:WORKS_FOR]-(melissa)-[:LIKES]-&gt;(graphs)&lt;-[:LIKES]-(diana)
CREATE (:Technology {type: "Python"})&lt;-[:LIKES]-(:Person {name: "Ryan"})-[:WORKS_FOR]-&gt;(:Company {name: "Company Z"})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cypher-filtering"><a class="anchor" href="#cypher-filtering"></a>An introduction to subqueries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Subqueries were introduced in Neo4j v4.0.</p>
</div>
<div class="paragraph">
<p>The following types of subqueries are possible in Neo4j:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://neo4j.com/docs/cypher-manual/current/syntax/expressions/#existential-subqueries"><code>EXISTS</code> subquery expression</a></p>
</li>
<li>
<p><a href="https://neo4j.com/docs/cypher-manual/current/syntax/expressions/#count-subqueries"><code>COUNT</code> subquery expression</a></p>
</li>
<li>
<p><a href="https://neo4j.com/docs/cypher-manual/5/clauses/call-subquery/"><code>CALL {&#8230;&#8203;}</code> subquery clause</a></p>
</li>
<li>
<p><a href="https://neo4j.com/docs/cypher-manual/5/clauses/call-subquery/#subquery-call-in-transactions"><code>CALL {&#8230;&#8203;} IN TRANSACTIONS</code> subquery clause</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>EXISTS</code>, <code>COUNT</code>, and <code>CALL {&#8230;&#8203;}</code> subqueries are covered in this section.
To learn more about using <code>CALL {&#8230;&#8203;} IN TRANSACTIONS</code>, see the code examples in the following tutorials on how to import CSV data into a Neo4j instance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../load-csv/#call-in-transactions" class="xref page"><em>Tutorial: Import data</em></a></p>
</li>
<li>
<p><a href="../../data-import/csv-import/#optimizing-load-csv" class="xref page"><em>Importing CSV data into Neo4j</em></a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cypher-subqueries"><a class="anchor" href="#cypher-subqueries"></a>Cypher subqueries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A subquery is a set of Cypher statements that execute within their own scope.
A subquery is typically called from an outer enclosing query.</p>
</div>
<div class="paragraph">
<p>Here are some important things to know about a subquery:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A subquery returns values referred to by the variables in the <code>RETURN</code> clause.</p>
</li>
<li>
<p>A subquery cannot return variables with the same name used in the enclosing query.</p>
</li>
<li>
<p>You must explicitly pass in variables from the enclosing query to a subquery.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Subqueries are demarcated by braces (<code>{ }</code>).</p>
</div>
<div class="paragraph">
<p>In the <a href="../results/#filter-patterns" class="xref page"><em>Filtering on patterns</em></a> section of the <strong><em>Getting the correct results</em></strong> chapter, you learnt how to filter based on patterns.
For example, you can write the following query to find the friends of someone who works for Neo4j:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH (p:Person)-[r:IS_FRIENDS_WITH]-&gt;(friend:Person)
WHERE exists((p)-[:WORKS_FOR]-&gt;(:Company {name: 'Neo4j'}))
RETURN p, r, friend</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you run this query in Neo4j Browser, the following graph is returned:</p>
</div>
<div class="imageblock popup-link">
<div class="content">
<img src="../../_images/friends-of-neo4j.png" alt="friends of neo4j" width="750">
</div>
<div class="title">Figure 2. Output in the graph format</div>
</div>
<div class="paragraph">
<p><a href="https://neo4j.com/docs/cypher-manual/current/syntax/expressions/#cypher-subquery-expressions" target="_blank" rel="noopener">Cypher subqueries</a> enable more powerful pattern filtering.
Instead of using the <code>exists</code> function in the <code>WHERE</code> clause, you can use the <code>EXISTS</code> subquery.
You can reproduce the previous example with the following query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH (p:Person)-[r:IS_FRIENDS_WITH]-&gt;(friend:Person)
WHERE EXISTS {
  MATCH (p)-[:WORKS_FOR]-&gt;(:Company {name: 'Neo4j'})
}
RETURN p, r, friend</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will get the same result, which is nice, but so far all you&#8217;ve achieved is the same thing with more code!</p>
</div>
<div class="paragraph">
<p>Next, let&#8217;s write a subquery that filters more powerfully than what can be achieved with the <code>WHERE</code> clause or the <code>exists</code> function alone.</p>
</div>
<div class="paragraph">
<p>Assume that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You want to find people who work for a company whose name starts with 'Company' and who like at least one technology that&#8217;s liked by three or more people.</p>
</li>
<li>
<p>You aren&#8217;t interested in knowing what those technologies are.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You might try to answer this question with the following query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH (person:Person)-[:WORKS_FOR]-&gt;(company)
WHERE company.name STARTS WITH "Company"
AND (person)-[:LIKES]-&gt;(t:Technology)
AND COUNT { (t)&lt;-[:LIKES]-() } &gt;= 3
RETURN person.name as person, company.name AS company;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you run this query, you&#8217;ll see the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Variable `t` not defined (line 4, column 25 (offset: 112))
"AND (person)-[:LIKES]-&gt;(t:Technology)"
                         ^</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can find people that like a technology, but you cannot check that at least three other people like that technology as well, because the variable <code>t</code> isn&#8217;t in the scope of the <code>WHERE</code> clause.
Let&#8217;s instead move the two <code>AND</code> statements into an <code>EXISTS</code> subquery block, resulting in the following query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH (person:Person)-[:WORKS_FOR]-&gt;(company)
WHERE company.name STARTS WITH "Company"
AND EXISTS {
  MATCH (person)-[:LIKES]-&gt;(t:Technology)
  WHERE COUNT { (t)&lt;-[:LIKES]-() } &gt;= 3
}
RETURN person.name as person, company.name AS company;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can successfully run the query, which returns the following results:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">person</th>
<th class="tableblock halign-left valign-top">company</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Melissa"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"CompanyA"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Diana"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"CompanyX"</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If you recall the graph visualisation from the start of this guide, <strong>Ryan</strong> is the only other person who works for a company which name starts with 'Company'.
He&#8217;s been filtered out in this query because the only <code>Technology</code> that he likes is <strong>Python</strong>, and there aren&#8217;t three other people who like Python.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="result-returning-subqueries"><a class="anchor" href="#result-returning-subqueries"></a>Result returning subqueries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>So far you have learnt how to use subqueries to filter out results, but this doesn&#8217;t fully show their power.
You can also use subqueries to return results as well.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s say you want to write a query that finds people who like Java or have more than one friend.
Apart from that, you want to return the results ordered by date of birth in descending order.
This can be partially achieved using the <code>UNION</code> clause and <code>COUNT</code> subquery expression:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH (p:Person)-[:LIKES]-&gt;(:Technology {type: "Java"})
RETURN p.name AS person, p.birthdate AS dob
ORDER BY dob DESC

UNION

MATCH (p:Person)
WHERE COUNT { (p)-[:IS_FRIENDS_WITH]-&gt;() } &gt; 1
RETURN p.name AS person, p.birthdate AS dob
ORDER BY dob DESC;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you run that query, you see the following output:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">person</th>
<th class="tableblock halign-left valign-top">dob</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Jennifer"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1988-01-01</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"John"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1985-04-04</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Joe"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1988-08-08</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You&#8217;ve got the correct people.
But the <code>UNION</code> approach only lets us sort results per <code>UNION</code> clause, not for all rows.</p>
</div>
<div class="paragraph">
<p>You can try another approach, where you execute each of the subqueries separately and collect the people from each part using the <code>collect()</code> function.
There are some people who like Java and have more than one friend, so you need to use <code>DISTINCT</code> operator in the <code>RETURN</code> clause to remove the duplicates:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">// Find people who like Java
MATCH (p:Person)-[:LIKES]-&gt;(:Technology {type: "Java"})
WITH collect(p) AS peopleWhoLikeJava

// Find people with more than one friend
MATCH (p:Person)
WHERE COUNT { (p)-[:IS_FRIENDS_WITH]-&gt;() } &gt; 1
WITH collect(p) AS popularPeople, peopleWhoLikeJava
WITH popularPeople + peopleWhoLikeJava AS people

// Unpack the collection of people and order by birthdate
UNWIND people AS p
RETURN DISTINCT p.name AS person, p.birthdate AS dob
ORDER BY dob DESC</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you run that query, you will get the following output:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">person</th>
<th class="tableblock halign-left valign-top">dob</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Joe"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1988-08-08</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Jennifer"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1988-01-01</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"John"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1985-04-04</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This approach works, but it&#8217;s more difficult to write, as you have to keep passing through parts of the query to its next part.</p>
</div>
<div class="paragraph">
<p>The <a href="https://neo4j.com/docs/cypher-manual/current/clauses/call-subquery/index.html" target="_blank" rel="noopener"><code>CALL {&#8230;&#8203;}</code></a> clause gives you the best of both worlds:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can use the UNION approach to run the individual queries and remove duplicates.</p>
</li>
<li>
<p>You can sort the results afterwards.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Our query using the <code>CALL {&#8230;&#8203;}</code> clause looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CALL {
	MATCH (p:Person)-[:LIKES]-&gt;(:Technology {type: "Java"})
	RETURN p

	UNION

	MATCH (p:Person)
	WHERE COUNT { (p)-[:IS_FRIENDS_WITH]-&gt;() } &gt; 1
	RETURN p
}
RETURN p.name AS person, p.birthdate AS dob
ORDER BY dob DESC;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you run that query, you will get the following output:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">person</th>
<th class="tableblock halign-left valign-top">dob</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Joe"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1988-08-08</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Jennifer"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1988-01-01</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"John"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1985-04-04</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You could extend the query further to return the technologies that these people like, and the friends that they have.
The following query shows how to do this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CALL {
	MATCH (p:Person)-[:LIKES]-&gt;(:Technology {type: "Java"})
	RETURN p

	UNION

	MATCH (p:Person)
	WHERE COUNT { (p)-[:IS_FRIENDS_WITH]-&gt;() } &gt; 1
	RETURN p
}
WITH p,
     [(p)-[:LIKES]-&gt;(t) | t.type] AS technologies,
     [(p)-[:IS_FRIENDS_WITH]-&gt;(f) | f.name] AS friends

RETURN p.name AS person, p.birthdate AS dob, technologies, friends
ORDER BY dob DESC;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">person</th>
<th class="tableblock halign-left valign-top">dob</th>
<th class="tableblock halign-left valign-top">technologies</th>
<th class="tableblock halign-left valign-top">friends</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Joe"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1988-08-08</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Query Languages"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Mark", "Diana"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Jennifer"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1988-01-01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Graphs", "Java"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Sally", "Mark", "John", "Ann", "Melissa"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"John"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1985-04-04</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Java", "Application Development"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Sally"]</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You can also apply aggregation functions to the results of the subquery.
The following query returns the youngest and oldest of the people who like Java or have more than one friend.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CALL {
	MATCH (p:Person)-[:LIKES]-&gt;(:Technology {type: "Java"})
	RETURN p

	UNION

	MATCH (p:Person)
	WHERE COUNT { (p)-[:IS_FRIENDS_WITH]-&gt;() } &gt; 1
	RETURN p
}
RETURN min(p.birthdate) AS oldest, max(p.birthdate) AS youngest</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">oldest</th>
<th class="tableblock halign-left valign-top">youngest</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1985-04-04</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1988-08-08</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_summary"><a class="anchor" href="#_summary"></a>Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You have seen how to use the <code>EXISTS {}</code> subquery expression to write complex filtering patterns and the <code>CALL {}</code> clause to execute result-returning subqueries.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="../large-statements/">Composing large statements</a></span>

  <span class="next"><a href="../schema/">Defining a schema</a></span>
</nav>
    <div class="feedback">
    <div class="header question">
        <p><strong>Was this page helpful?</strong></p>

        <svg width="22px" height="22px" viewBox="0 0 22 22" role="button" class="no" aria-label="No, this page isn't helpful">
            <path
                d="M6.25,15.8333333 C6.25,13.7622655 7.92893219,12.0833333 10,12.0833333 C12.0710678,12.0833333 13.75,13.7622655 13.75,15.8333333"
                ></path>
            <circle  cx="10" cy="10" r="9.58333333"></circle>
            <path
                d="M12.5,4.58333333 C12.8934466,4.05873783 13.5109223,3.75 14.1666667,3.75 C14.822411,3.75 15.4398867,4.05873783 15.8333333,4.58333333"
                ></path>
            <line x1="4.58333333" y1="7.91666667" x2="7.08333333" y2="7.91666667" ></line>
            <path
                d="M7.08333333,8.54166667 C6.96827401,8.54166667 6.875,8.44839266 6.875,8.33333333 C6.875,8.21827401 6.96827401,8.125 7.08333333,8.125 C7.19839266,8.125 7.29166667,8.21827401 7.29166667,8.33333333 C7.29166667,8.44839266 7.19839266,8.54166667 7.08333333,8.54166667"
                ></path>
            <line x1="12.9166667" y1="7.91666667" x2="15.4166667" y2="7.91666667" ></line>
            <path
                d="M15.4166667,8.54166667 C15.3016073,8.54166667 15.2083333,8.44839266 15.2083333,8.33333333 C15.2083333,8.21827401 15.3016073,8.125 15.4166667,8.125 C15.531726,8.125 15.625,8.21827401 15.625,8.33333333 C15.625,8.44839266 15.531726,8.54166667 15.4166667,8.54166667"
                ></path>
            <path
                d="M4.16666667,4.58333333 C4.5601133,4.05873783 5.17758895,3.75 5.83333333,3.75 C6.48907772,3.75 7.10655337,4.05873783 7.5,4.58333333"
                ></path>
        </svg>

        <svg width="22px" height="22px" viewBox="0 0 22 22" role="button" class="yes" aria-label="Yes, this page is helpful">
            <circle  cx="10" cy="10" r="9.58333333"></circle>
            <path
                d="M5.41666667,8.125 C5.53172599,8.125 5.625,8.21827401 5.625,8.33333333 C5.625,8.44839266 5.53172599,8.54166667 5.41666667,8.54166667 C5.30160734,8.54166667 5.20833333,8.44839266 5.20833333,8.33333333 C5.20833333,8.21827401 5.30160734,8.125 5.41666667,8.125"
                ></path>
            <path
                d="M14.5833333,8.125 C14.468274,8.125 14.375,8.21827401 14.375,8.33333333 C14.375,8.44839266 14.468274,8.54166667 14.5833333,8.54166667 C14.6983927,8.54166667 14.7916667,8.44839266 14.7916667,8.33333333 C14.7916667,8.21827401 14.6983927,8.125 14.5833333,8.125"
                ></path>
            <path
                d="M13.2275,12.9166657 C13.4853075,12.9162808 13.7287776,13.035241 13.8869095,13.2388563 C14.0450415,13.4424715 14.1000278,13.7078123 14.0358333,13.9575 C13.562901,15.7999679 11.9021969,17.0882321 10,17.0882321 C8.09780311,17.0882321 6.43709903,15.7999679 5.96416667,13.9575 C5.89997223,13.7078123 5.95495852,13.4424715 6.11309045,13.2388563 C6.27122239,13.035241 6.51469246,12.9162808 6.7725,12.9166657 L13.2275,12.9166657 Z"
                ></path>
        </svg>
    </div>


</div></article>
<aside class="toc sidebar" data-title="Contents"
  data-levels="2">
  <div class="toc-menu">
    <div class="toc-menu-placeholder"></div>

    <div class="toc-ad">
    <div class="toc-ad-overline">
        <a href="https://graphacademy.neo4j.com/courses/cypher-fundamentals/?ref=docs" target="_blank">

        Neo4j GraphAcademy

        </a>
    </div>

    <a href="https://graphacademy.neo4j.com/courses/cypher-fundamentals/?ref=docs" target="_blank">

        <h2 class="toc-ad-title">
            Cypher Fundamentals
        </h2>

        <p class="toc-ad-description">Learn Cypher in this free, hands-on course</p>

        <div class="toc-ad-underline button">
            Learn more
        </div>
    </a>
</div>
  </div>
  </aside>  </div>
</main>
</div>
<footer class="footer">
  <div class="wrapper">
  <div class="column">
    <div class="logo-footer"></div>
    <p>© <span id="footer-copyright-year">2023</span> Neo4j, Inc.<br>
      <a href="https://neo4j.com/terms/">Terms</a> | <a href="https://neo4j.com/privacy-policy/">Privacy </a> | <a href="https://neo4j.com/sitemap/">Sitemap</a></p>
    <p>Neo4j<sup>®</sup>, Neo Technology<sup>®</sup>, Cypher<sup>®</sup>, Neo4j<sup>®</sup> Bloom<sup>™</sup> and
      Neo4j<sup>®</sup> Aura<sup>™</sup> are registered trademarks
      of Neo4j, Inc. All other marks are owned by their respective companies.</p>
  </div>

  <div class="column">
    <h2><a href="https://neo4j.com/contact-us/?ref=footer">Contact Us →</a></h2>
    <p>US: 1-855-636-4532<br>
      Sweden +46 171 480 113<br>
      UK: +44 20 3868 3223<br>
      France: +33 (0) 1 88 46 13 20<br>
      <!--Germany: +49 (0)89 26204 6300</p>-->
    </p>
  </div>
  <div class="column links">
    <h2>Learn</h2>
    <ul>
      <li><i class="fa fa-wrench" aria-hidden="true"></i> <a rel="noopener" href="https://neo4j.com/sandbox/?ref=developer-footer">Sandbox</a></li>
      <li><i class="fa fa-comments-o" aria-hidden="true"></i> <a rel="noopener" href="https://community.neo4j.com?ref=developer-footer" target="_blank">Neo4j Community Site</a></li>
      <li><i class="fa fa-book" aria-hidden="true"></i> <a rel="noopener" href="https://medium.com/neo4j" target="_blank">Neo4j Developer Blog</a></li>
      <li><i class="fa fa-youtube" aria-hidden="true"></i> <a rel="noopener" href="https://www.youtube.com/neo4j" target="_blank">Neo4j Videos</a></li>
      <li><i class="fa fa-graduation-cap" aria-hidden="true"></i> <a rel="noopener" href="https://neo4j.com/graphacademy/?ref=developer-footer">GraphAcademy</a></li>
      <li><i class="fa fa-flask" aria-hidden="true"></i> <a href="https://neo4j.com/labs/?ref=developer-footer">Neo4j Labs</a></li>
    </ul>
  </div>
  <div class="column links">
    <h2>Social</h2>
    <ul>
      <li><i class="fa fa-twitter" aria-hidden="true"></i> <a rel="noopener" href="https://twitter.com/neo4j" target="_blank">Twitter</a></li>
      <li><i class="fa fa-meetup" aria-hidden="true"></i> <a rel="noopener" href="https://www.meetup.com/Neo4j-Online-Meetup/" target="_blank">Meetups</a></li>
      <li><i class="fa fa-github" aria-hidden="true"></i> <a rel="noopener" href="https://github.com/neo4j/neo4j" target="_blank">Github</a></li>
      <li><i class="fa fa-stack-overflow" aria-hidden="true"></i> <a rel="noopener" href="https://stackoverflow.com/questions/tagged/neo4j" target="_blank">Stack Overflow</a></li>

      <li class="speaker-program"><a href="https://docs.google.com/forms/d/e/1FAIpQLSdEcNnMruES5iwvOVYovmS1D_P1ZL_HdUOitFrwrvruv5PZvA/viewform">Want to Speak?</a></li>
    </ul>
  </div>
</div>
</footer>

  <script src="../../../assets/js/vendor/auth0.js"></script>
  <script src="../../../assets/js/site.js"></script>
  <script async src="../../../assets/js/vendor/highlight.js"></script>
  <script async src="../../../assets/js/vendor/image-zoom.js"></script>


<div id="neo4j-algolia-search-v2"></div>
<script src="https://neo4j.com/wp-content/themes/neo4jweb/assets/neo4j-react-modules-assets/search-preact/chunkless/bundle.js"></script>
<script src="https://neo4j.com/wp-content/themes/neo4jweb/assets/neo4j-react-modules-assets/search-preact/chunkless/polyfill.js"></script>
<script>window.algoliaSearchOptions = {indexName: "docs",placeholder: "Search Documentation",template: "docs"}</script>  </body>
</html>
